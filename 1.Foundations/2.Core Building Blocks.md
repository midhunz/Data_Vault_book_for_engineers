# Chapter 2: Core Building Blocks


## 2.1 A Day in the Supermarket

It‚Äôs 8 a.m. and the supermarket chain‚Äôs flagship store just opened.  
Customers begin scanning loyalty cards, baskets fill up with groceries, the bakery counter logs dozens of fresh croissants, and the point-of-sale system starts recording transactions every second.

Meanwhile, in the company‚Äôs data platform, thousands of new records stream in:  
**sales**, **inventory updates**, **price changes**, **customer sign-ups**, and **supplier deliveries**.  
By noon, every system ‚Äî from billing to loyalty programs ‚Äî is producing more data than an entire store did a decade ago.

The data team‚Äôs job is to bring order to this storm. They need a model that can **connect all this activity**, **store it efficiently**, and **keep a full history** of every change.

That‚Äôs where the **Data Vault building blocks** come in.  
They are the architecture‚Äôs **foundation stones** ‚Äî simple pieces that fit together to capture *who*, *what*, *when*, and *how* across every corner of the supermarket business.


## 2.2 Hubs ‚Äî The Business Anchors

### What They Are
A **Hub** represents a *unique business key* ‚Äî a core concept that exists independently in the supermarket.

Think of:
- **Customer** ‚Äî identified by `CUSTOMER_ID`  
- **Product** ‚Äî identified by `PRODUCT_ID`  
- **Store** ‚Äî identified by `STORE_ID`

Each Hub contains:
- A hashed surrogate key  
- The natural business key  
- Metadata such as load timestamp and record source  



### Analogy
Imagine a wall of **filing cabinets**:
- One cabinet for *Customers*  
- One for *Products*  
- One for *Stores*

Every drawer inside holds a unique folder ‚Äî that‚Äôs a **Hub record**.  
No matter how systems evolve, these cabinets always define the supermarket‚Äôs core entities.



### Example: `HUB_CUSTOMER`

| Column | Description |
|---------|-------------|
| CUSTOMER_HK | Hash key generated from `CUSTOMER_ID` |
| CUSTOMER_ID | Natural business key (loyalty number) |
| LOAD_DTS | Record load timestamp |
| SRC | Source system |

> üß© *Purpose:* Hubs establish consistent identities across systems ‚Äî a single, trustworthy definition of ‚Äúwho‚Äù or ‚Äúwhat‚Äù.



## 2.3 Links ‚Äî The Relationships

### What They Are
A **Link** represents a *relationship or transaction* between two or more Hubs.

In our supermarket:
- A **Sale** connects a *Customer*, *Product*, and *Store*  
- A **Shipment** connects a *Supplier* and a *Store*  
- A **Promotion Participation** connects a *Customer* and a *Campaign*

Each Link includes:
- The hash keys of related Hubs  
- Its own Link hash key  
- Load metadata  



### Analogy
If Hubs are filing cabinets, then Links are the **paper clips** that tie folders together.  
Every receipt, every transaction, every connection between entities is recorded here.

> üßæ *Purpose:* Links capture *how entities interact* ‚Äî turning isolated lists into a connected network.



### Example: `LNK_SALE`

| Column | Description |
|---------|-------------|
| SALE_HK | Unique hash for the sale |
| CUSTOMER_HK | Reference to `HUB_CUSTOMER` |
| PRODUCT_HK | Reference to `HUB_PRODUCT` |
| STORE_HK | Reference to `HUB_STORE` |
| LOAD_DTS | Load timestamp |
| SRC | Source system |



## 2.4 Satellites ‚Äî The Context and History

### What They Are
While Hubs and Links show structure, **Satellites** hold the *descriptive details* ‚Äî names, prices, addresses, discounts, and every historical change.

Examples:
- `SAT_CUSTOMER_DETAILS` ‚Äî name, phone, loyalty tier  
- `SAT_PRODUCT_PRICING` ‚Äî price, discount, effective date  
- `SAT_STORE_INFO` ‚Äî address, region, manager  

Each Satellite includes:
- Descriptive attributes  
- Hash diff for change detection  
- Load timestamp and record source  



### Story Analogy
Picture each Hub‚Äôs folder growing thicker over time.  
Every time a customer updates their email or a product price changes, a new page is slipped into the folder ‚Äî never deleting the old one.  
That‚Äôs exactly how Satellites work.



### Example: `SAT_PRODUCT_PRICING`

| Column | Description |
|---------|-------------|
| PRODUCT_HK | Reference to `HUB_PRODUCT` |
| PRICE | Current price |
| DISCOUNT | Discount applied |
| EFFECTIVE_DATE | When this price became active |
| HASHDIFF | Detects attribute changes |
| LOAD_DTS | Load timestamp |
| SRC | Source system |

> üí° *Purpose:* Satellites give the supermarket full **historical traceability** ‚Äî every change is preserved for audit and analysis.



## 2.5 Reference Tables ‚Äî The Legends

### What They Are
**Reference tables** store controlled vocabularies ‚Äî static lists that bring meaning to data.  

In the supermarket:
- Payment methods (Cash, Card, Loyalty Points)  
- Product categories (Beverages, Bakery, Frozen)  
- Store regions (North, South, East, West)

They rarely change and don‚Äôt require hashing or full audit tracking.



### Analogy
If the Data Vault is a map, reference tables are the **legend** explaining the symbols.  
They keep everyone speaking the same language.

> üß≠ *Purpose:* Provide consistency and standardization across all systems.



## 2.6 PIT and Bridge Tables ‚Äî Speed and Accessibility

### Point-in-Time (PIT)
A **PIT table** gives a *snapshot* of data at a chosen moment ‚Äî like checking all product prices as of midnight.  

Example: `PIT_PRODUCT_STATUS` holds each product‚Äôs latest price and availability at day-end.

> üïì *Purpose:* Makes ‚Äúas-of-date‚Äù queries simple and fast.



### Bridge Tables
**Bridge tables** flatten or aggregate data to support reporting and analytics.  
They are often built in the Business Vault layer.

Examples:
- `BRIDGE_CUSTOMER_ACTIVITY` ‚Äî total spend, last purchase date  
- `BRIDGE_STORE_PERFORMANCE` ‚Äî weekly sales totals per store

> ‚öôÔ∏è *Purpose:* Turn detailed history into **business-ready summaries** for dashboards.



## 2.7 Raw Vault vs Business Vault vs Information Marts

| Layer | Analogy | Purpose | Example |
|--------|----------|----------|----------|
| **Raw Vault** | Warehouse shelves ‚Äî every item safely stored in its raw form | Preserve complete, auditable data from sources | `HUB_PRODUCT`, `LNK_SALE`, `SAT_PRODUCT_PRICING` |
| **Business Vault** | Packaging and labeling area ‚Äî organize, enrich, and apply business logic | Add calculations and KPIs | `BRIDGE_CUSTOMER_ACTIVITY`, `SAT_PROMOTION_EFFECTIVENESS` |
| **Information Mart** | Storefront ‚Äî where customers choose what they need | Deliver data for reports and dashboards | `DIM_CUSTOMER`, `FACT_SALES` |



### Closing Story

By the time the supermarket closes, millions of events have flowed through the Data Vault:
- Every scanned item recorded as a **Link**  
- Every customer identity preserved in a **Hub**  
- Every price or promotion stored in a **Satellite**

From the outside, it looks like business as usual.  
But under the hood, the Data Vault quietly keeps a perfect memory ‚Äî every sale, every change, every version ‚Äî ready for tomorrow‚Äôs analysis.
